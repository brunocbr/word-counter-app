<!DOCTYPE html>
<html>
<head>
    <title>Word Counter</title>
    <!-- Include ECharts library -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <style>
     #main {
         width: 160px;
         height: 200px;
         background-color: #f5f5f5; /* Light Gray background */
         margin: 0 auto;
         padding: 5px;
         border-radius: 5px;
         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
         font-family: Helvetica, sans-serif;
     }
     #motivationalMessage {
         text-align: center;
         margin-top: 0px; /* Add some space above the message */
         font-family: Helvetica, sans-serif;
         font-size: small;
         color: #2196F3;
     }
     #chart {
         width: 160px;
         height: 150px;
     }
    </style>
</head>
<body>
    <div id="main">
        <div id="chart"></div>
        <div id="motivationalMessage"></div>
    </div>
    <script>
     var chartDom = document.getElementById('chart');
     var myChart = echarts.init(chartDom);
     var option;

     const initialWordCount = {{ word_count }} || 0;
     const initialTargetWords = {{ target_words }};

     function calcProgress(count, target) {
         if (target == undefined || target == 0) {
             return 0;
         } else {
             return count / target;
         }
     }

     function chartColor(progress) {
         if (progress > 1.0) {
             return '#f44336'; /* Red */
         } else if (progress >= 0.9) {
             return '#4caf50';  /* Green */
         } else if (progress >= 0.1) {
             return '#3f51b5'; /* Blue */
         } else {
             return '#64B5F6'; /* light blue */
         }
     }

         // Get the system's current locale
         const currentLocale = navigator.language || navigator.userLanguage;

     const wordTranslations = {
         'word': {
             'en': {
                 's': 'word',
                 'p': 'words'
             },  // English
             'fr': {
                 's': 'mot',
                 'p': 'mots'
             },    // French
             'de': {
                 's': 'Wort',
                 'p': 'WÃ¶rter'
             },   // German
             'es': {
                 's': 'palabra',
                 'p': 'palabras'
             },   // Spanish
             'pt': {
                 's': 'palavra',
                 'p': 'palavras'
             }, // Portuguese
             'pt-BR': {
                 's': 'palavra',
                 'p': 'palavras'
             }    // Brazilian Portuguese
             // Add more languages as needed
     }};

     const motivationalMessages = {
         'en': [
             "Keep going! You're doing great!",
             "You're almost there! Keep pushing!",
             "You're making excellent progress!",
             "You're on fire! Keep up the momentum!",
             "You're a writing machine! Keep it up!"
         ],
         'fr': [
             "Continuez comme Ã§a ! Vous Ãªtes gÃ©nial !",
             "Vous y Ãªtes presque ! Continuez Ã  pousser !",
             "Vous faites des progrÃ¨s excellents !",
             "Vous Ãªtes en feu ! Gardez le momentum !",
             "Vous Ãªtes une machine Ã  Ã©crire ! Continuez comme Ã§a !"
         ],
         'es': [
             "Â¡Sigue adelante! Â¡Lo estÃ¡s haciendo genial!",
             "Â¡Casi lo logras! Â¡Sigue adelante!",
             "Â¡EstÃ¡s haciendo un progreso excelente!",
             "Â¡EstÃ¡s en llamas! Â¡Sigue asÃ­!",
             "Â¡Eres una mÃ¡quina de escribir! Â¡Sigue asÃ­!"
         ],
         'pt': [
             "VocÃª estÃ¡ no caminho certo! Continue assim!",
             "Cada palavra conta! VocÃª estÃ¡ quase lÃ¡!",
             "Seu progresso Ã© impressionante, continue assim!",
             "VocÃª estÃ¡ arrasando! Mantenha o ritmo!",
             "VocÃª Ã© incrÃ­vel! Continue escrevendo!"
         ],
         'pt-BR': [
             "Continue assim. Cada palavra Ã© um passo em direÃ§Ã£o ao seu objetivo.",
             "VocÃª estÃ¡ fazendo um Ã³timo trabalho. SÃ³ mais um pouco e vocÃª chegarÃ¡ lÃ¡.",
             "Seu progresso Ã© impressionante. Continue assim.",
             "VocÃª estÃ¡ arrasando. Mantenha o ritmo.",
             "VocÃª Ã© incrÃ­vel. Continue escrevendo.",
             "Continue assim. Cada palavra Ã© um passo em direÃ§Ã£o ao seu objetivo.",
             "VocÃª estÃ¡ fazendo um Ã³timo trabalho. SÃ³ mais um pouco e vocÃª chegarÃ¡ lÃ¡.",
             "Seu progresso Ã© notÃ¡vel. Continue firme.",
             "EstÃ¡ cada vez melhor. NÃ£o desista agora.",
             "VocÃª estÃ¡ se superando a cada palavra. Continue assim.",
             "Cada parÃ¡grafo Ã© uma conquista. Continue escrevendo.",
             "Sua dedicaÃ§Ã£o Ã© inspiradora. Continue seguindo em frente.",
             "Estou impressionado com sua persistÃªncia. Continue assim.",
             "VocÃª estÃ¡ no caminho certo. Continue avanÃ§ando.",
             "Cada pÃ¡gina escrita Ã© uma vitÃ³ria. Continue firme.",
             "Continue assim. O mundo estÃ¡ esperando para ler sua histÃ³ria.",
             "VocÃª estÃ¡ deixando sua marca. Continue escrevendo.",
             "Sua criatividade estÃ¡ fluindo. Continue seguindo sua inspiraÃ§Ã£o.",
             "VocÃª estÃ¡ escrevendo com o coraÃ§Ã£o. Continue assim.",
             "Cada capÃ­tulo Ã© uma jornada. Continue escrevendo.",
             "Seu talento Ã© incrÃ­vel. Continue compartilhando suas palavras.",
             "Estou ansioso para ver onde sua escrita o levarÃ¡. Continue assim.",
             "Sua paixÃ£o pela escrita Ã© inspiradora. Continue seguindo seus sonhos.",
             "Continue assim. Sua histÃ³ria merece ser contada.",
             "Cada palavra Ã© uma obra-prima. Continue escrevendo.",
             "Seu estilo Ãºnico estÃ¡ brilhando. Continue assim.",
             "VocÃª estÃ¡ cativando seus leitores. Continue contando sua histÃ³ria.",
             "Cada linha Ã© um feito. Continue firme.",
             "Estou torcendo por vocÃª a cada palavra. Continue escrevendo.",
             "Sua determinaÃ§Ã£o Ã© admirÃ¡vel. Continue seguindo em frente.",
             "Continue assim. Sua voz Ã© Ãºnica e importante.",
             "Cada frase Ã© uma inspiraÃ§Ã£o. Continue compartilhando suas ideias.",
             "Sua escrita Ã© poderosa. Continue transmitindo sua mensagem.",
             "Continue assim. VocÃª estÃ¡ transformando pensamentos em palavras.",
             "Seu talento Ã© extraordinÃ¡rio. Continue escrevendo com paixÃ£o."
         ],
         'de': [
             "Weiter so! Du machst das groÃŸartig!",
             "Du bist fast da! Weiter so!",
             "Du machst ausgezeichnete Fortschritte!",
             "Du bist voll im Flow! Weiter so!",
             "Du bist eine Schreibmaschine! Mach weiter so!"
         ]
     }


     const cutTheTextMessages = {
         'en': [
             "Great work! Let's refine this and make every word count.",
             "Almost there! Less is more. Highlight what really matters.",
             "Excellent progress! Cut words to make your text more powerful.",
             "Impressive! Remove unnecessary words and highlight the main ideas.",
             "Congratulations! Make your message clearer and more impactful."
         ],
         'fr': [
             "Excellent travail! Affinons ce message et faisons chaque mot compter.",
             "Presque lÃ ! Moins, c'est mieux. Mettez en avant l'essentiel.",
             "Excellents progrÃ¨s! Coupez quelques mots pour rendre le texte puissant.",
             "Impressionnant! Supprimez les mots inutiles et mettez en avant les idÃ©es.",
             "FÃ©licitations! Rendons votre message clair et percutant."
         ],
         'es': [
             "Â¡Gran trabajo! Refina esto y haz que cada palabra cuente.",
             "Â¡Casi lo logras! Menos es mÃ¡s. Destaca lo importante.",
             "Â¡Excelente progreso! Recorta palabras para hacer tu texto poderoso.",
             "Â¡Impresionante! Elimina palabras innecesarias y resalta las ideas.",
             "Â¡Felicidades! Haz tu mensaje claro e impactante."
         ],
         'pt': [
             "Ã“timo trabalho! Vamos refinar e garantir impacto.",
             "Quase lÃ¡! Menos Ã© mais. Destaque o importante.",
             "Excelente progresso! Corte palavras para deixar o texto poderoso.",
             "Impressionante! Remova palavras desnecessÃ¡rias e destaque ideias.",
             "ParabÃ©ns! Torne sua mensagem clara e impactante."
         ],
         'pt-BR': [
             "Ã“timo trabalho! Vamos refinar e garantir impacto.",
             "Quase lÃ¡! Menos Ã© mais. Destaque o importante.",
             "Excelente progresso! Corte palavras para deixar o texto poderoso.",
             "Impressionante! Remova palavras desnecessÃ¡rias e destaque ideias.",
             "ParabÃ©ns! Torne sua mensagem clara e impactante."
         ],
         'de': [
             "GroÃŸartige Arbeit! Lass uns jedes Wort zÃ¤hlen lassen.",
             "Fast geschafft! Weniger ist mehr. Hebe das Wesentliche hervor.",
             "Ausgezeichnete Fortschritte! KÃ¼rze WÃ¶rter fÃ¼r einen kraftvollen Text.",
             "Beeindruckend! Entferne unnÃ¶tige WÃ¶rter und hebe die Hauptideen hervor.",
             "GlÃ¼ckwunsch! Mache deine Botschaft klarer und eindrucksvoller."
         ]
     };

     function getWord(word, count) {
         const form = count > 1 ? 'p' : 's';
         return wordTranslations[word][currentLocale][form]
             || wordTranslations[word]['en'][form];
     }

     function getMessage(progress) {
         // Usar mensagens de corte se o progresso exceder o comprimento das mensagens motivacionais
         const messages = progress >= 1
                        ? cutTheTextMessages[currentLocale] || cutTheTextMessages['en']
                        : motivationalMessages[currentLocale] || motivationalMessages['en'];

         p = progress >= 1 ? progress - 1.0 : progress

         // Garantir que o Ã­ndice nÃ£o exceda o comprimento das mensagens disponÃ­veis
         let messageIndex = Math.floor(p * messages.length);
         return messages[messageIndex] || 'ðŸ˜µ';
     }

     const gaugeData = [
         {
             value: initialWordCount,
             name: getWord('word', initialWordCount),
             detail: {
                 valueAnimation: true,
                 offsetCenter: ['0%', '0%']
             }
         }
     ];

     option = {
         series: [
             {
                 type: 'gauge',
                 min: 0,
                 max: initialTargetWords || initialWordCount,
                 startAngle: 90,
                 endAngle: -270,
                 color: chartColor(calcProgress(initialWordCount, initialTargetWords)),
                 fontFamily: "Helvetica, sans-serif",
                 pointer: {
                     show: false
                 },
                 progress: {
                     show: true,
                     overlap: false,
                     clip: true,
                     itemStyle: {
                         borderWidth: 0
                     }
                 },
                 axisLine: {
                     lineStyle: {
                         width: 18
                     }
                 },
                 splitLine: {
                     show: false,
                 },
                 axisTick: {
                     show: false
                 },
                 axisLabel: {
                     show: false,
                 },
                 data: gaugeData,
                 title: {
                     fontSize: 8
                 },
                 detail: {
                     fontSize: 16,
                     color: 'inherit',
                     borderColor: 'inherit',
                     formatter: (value) => { return value.toLocaleString() }
                 }
             }
         ]
     };

     function updateChart() {
         fetch('/data')
             .then(response => response.json())
             .then(data => {
                 const word_count = data.word_count;
                 let targetWords = data.target_words;
                 let progressPercentage = calcProgress(word_count, targetWords);
                 let color = chartColor(progressPercentage);

                 const gaugeData = [
                     {
                         value: word_count,
                         name: getWord('word', word_count),
                         detail: {
                             valueAnimation: true,
                             offsetCenter: ['0%', '0%']
                         }
                     }
                 ];

                 myChart.setOption({
                     series: [
                         {
                             data: gaugeData,
                             max: targetWords || word_count,
                             pointer: {
                                 show: false
                             },
                             color: color
                         }]})

                 // Update motivational messages based on progress
                 let msgElement = document.getElementById('motivationalMessage');
                 msgElement.style.color = color;
                 msgElement.innerText = getMessage(progressPercentage);
     })}

     setInterval(updateChart, 4000);

     option && myChart.setOption(option);
    </script>
</body>
</html>

